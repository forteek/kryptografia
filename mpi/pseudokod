Przyjmij liczebność sekundantow - zapamiętaj, że to pula dostępnych sekundantów
Przyjmij liczebność pokoi szpitalnych - zapamiętaj, że to pula dostępnych pokoi szpitalnych

Liczba par to liczebność weteranów podzielona przez dwa
Utwórz rozróznialne miejsca w parach, w liczbie [liczba par razy dwa]

Dla każdego z weteranów:
	Utwórz własny proces
	Dołącz do kanału komunikacyjnego
	Zapamiętaj przydzielony Ci identyfikator w kanale
	Zapamiętaj, że twój zegar Lamporta ma wartość 0
	Zapamiętaj, że wszyscy pozostali weterani mają teraz zegar Lamporta o wartości 0
	Zapamiętaj, że w kolejce do sekcji krytycznej nie ma nikogo
	Zapamiętaj, że żaden z weteranów jeszcze nie udzielił ci zgody na wejście do sekcji krytycznej

	Zwiększ wartość swojego zegaru Lamporta o 1
	Poproś innych weteranów o dostęp do sekcji krytycznej
	Zapamiętaj, że jesteś w kolejce do sekcji krytycznej
	Poczekaj na wiadomości od innych weteranów

	Jeżeli wiadomość to prośba o dostęp do sekcji krytycznej:

		Jeżeli wiadomość pochodzi od weterana o niższym identyfikatorze:

			Wyraź zgodę na wejście nadawcy wiadomości do sekcji krytycznej
			Zapamiętaj, że nadawca wiadomości jest przed Tobą w kolejce do sekcji krytycznej

		W przeciwnym wypadku:

			Zapamiętaj, że nadawca wiadomości jest po Tobie w kolejce do sekcji krytycznej

	W przeciwnym wypadku, jeżeli wiadomość to zgoda na wejście do sekcji krytycznej:

		Zapamiętaj, że weteran wyraził zgodę na twoje wejście do sekcji krytycznej

		Jeżeli otrzymałeś zgodę na wejście od każdego z weteranów:

			Wejdź do sekcji krytycznej w celu dobrania przeciwnika
			Po wyjściu z sekcji krytycznej wyraź zgodę na wejście do sekcji krytycznej każdemu, kto jest po tobie w kolejce
			Jeżeli zająłeś drugie miejsce w parze:

				Wylosuj liczbę obrażeń, jaką zadałeś rywalowi w pojedynku
				Powiadom swojego rywala, ile zadałeś mu obrażeń
				Oczekuj wiadomości zwrotnej po pojedynku
				Zareaguj na wynik pojedynku

			Jeżeli zająłeś pierwsze miejsce w parze:

				Wylosuj liczbę obrażeń, jaką zadasz rywalowi w pojedynku
				Oczekuj wiadomości o gotowości rywala
				Gdy otrzymasz wiadomość o gotowości rywala:
					
					Jeżeli zadałeś mniej obrażeń niż on:

						Przegrywasz

					W przeciwnym wypadku:

						Wygrywasz

					Powiadom swojego rywala o wyniku pojedynku
					Zareaguj na wynik pojedynku

		Jeżeli nie otrzymałeś jeszcze zgody od każdego z weteranów:

			Wróc do oczekiwania na wiadomości od innych weteranów

Wejście do sekcji krytycznej w celu dobrania przeciwnika:

	Zajmij pierwsze wolne miejsce w pierwszej wolnej parze
	Zabierz jednego sekundanta z puli dostępnych sekundantów
	Wyjdź z sekcji krytycznej

Reagowanie na wynik pojedynku:

	Jeżeli wygrałeś:

		Wyraź swoje zadowolenie z przebiegu potyczki
		Poproś o dostęp do sekcji krytycznej
		Po uzyskaniu zgody na dostęp do sekcji krytycznej oddaj sekundanta do puli dostępnych sekundantów
		Wróć do początku programu - zabieganie o dostęp do sekcji krytycznej w celu znalezienia partnera do pojedynku

	W przeciwnym wypadku:

		Poproś o dostęp do sekcji krytycznej
		Po uzyskaniu zgody na dostęp do sekcji krytycznej zabierz jeden pokój szpitalny z puli dostępnych pokoi szpitalnych oraz oddaj sekundanta o puli dostępnych sekundantów
		Odbądź pobyt w szpitalu

Pobyt w szpitalu:

	Śpij 30 sekund
	Poproś o dostęp do sekcji krytycznej
	Po uzyskaniu zgody na dostęp do sekcji krytycznej od każdego, oddaj jeden pokój szpitalny do puli dostępnych pokoi szpitalnych
	Wróć do początku programu - zabieganie o dostęp do sekcji krytycznej w celu znalezienia partnera do pojedynku
